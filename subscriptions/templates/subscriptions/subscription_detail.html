{% extends 'base.html' %}

{% block title %}{{ subscription.name }} - Subscription Details{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="flex items-center justify-between mb-8">
            <div class="flex items-center">
                <a href="{% url 'subscriptions:subscription_list' %}" class="btn btn-ghost btn-sm mr-4">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    Back to Subscriptions
                </a>
                <h1 class="text-3xl font-bold text-gray-800">{{ subscription.name }}</h1>
            </div>
            <div class="flex space-x-2">
                <a href="{% url 'subscriptions:subscription_update' subscription.pk %}" class="btn btn-primary">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    Edit
                </a>
                <a href="{% url 'subscriptions:subscription_delete' subscription.pk %}" class="btn btn-error">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                    Delete
                </a>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Information -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Basic Info Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4">Basic Information</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Subscription Name</label>
                                <p class="text-lg font-semibold">{{ subscription.name }}</p>
                            </div>
                            {% if subscription.provider %}
                            <div>
                                <label class="text-sm font-medium text-gray-600">Provider</label>
                                <p class="text-lg">{{ subscription.provider }}</p>
                            </div>
                            {% endif %}
                            <div>
                                <label class="text-sm font-medium text-gray-600">Amount</label>
                                <p class="text-2xl font-bold text-primary">${{ subscription.amount }}</p>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Billing Cycle</label>
                                <p class="text-lg">{{ subscription.get_billing_cycle_display }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dates Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4">Important Dates</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Start Date</label>
                                <p class="text-lg">{{ subscription.start_date }}</p>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Next Due Date</label>
                                <p class="text-lg font-semibold {% if subscription.next_due_date < today %}text-error{% else %}text-success{% endif %}">
                                    {{ subscription.next_due_date }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API Configuration Card -->
                {% if subscription.is_api_enabled %}
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4 flex items-center">
                            <svg class="w-5 h-5 mr-2 text-info" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                            </svg>
                            API Configuration
                        </h2>
                        <div class="space-y-4">
                            {% if subscription.api_base_url %}
                            <div>
                                <label class="text-sm font-medium text-gray-600">API Base URL</label>
                                <p class="text-sm font-mono bg-gray-100 p-2 rounded">{{ subscription.api_base_url }}</p>
                            </div>
                            {% endif %}
                            {% if subscription.api_key %}
                            <div>
                                <label class="text-sm font-medium text-gray-600">API Key</label>
                                <p class="text-sm font-mono bg-gray-100 p-2 rounded">{{ subscription.api_key|truncatechars:20 }}...</p>
                            </div>
                            {% endif %}
                            {% if subscription.api_token %}
                            <div>
                                <label class="text-sm font-medium text-gray-600">API Token</label>
                                <p class="text-sm font-mono bg-gray-100 p-2 rounded">{{ subscription.api_token|truncatechars:30 }}...</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Notes Card -->
                {% if subscription.notes %}
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4">Notes</h2>
                        <p class="text-gray-700 whitespace-pre-wrap">{{ subscription.notes }}</p>
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                <!-- Status Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title text-lg mb-4">Status</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium text-gray-600">Active</span>
                                <div class="badge {% if subscription.is_active %}badge-success{% else %}badge-error{% endif %}">
                                    {% if subscription.is_active %}Yes{% else %}No{% endif %}
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium text-gray-600">API Enabled</span>
                                <div class="badge {% if subscription.is_api_enabled %}badge-info{% else %}badge-neutral{% endif %}">
                                    {% if subscription.is_api_enabled %}Yes{% else %}No{% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timestamps Card -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title text-lg mb-4">Timestamps</h3>
                        <div class="space-y-3">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Created</label>
                                <p class="text-sm">{{ subscription.created_at|date:"M d, Y H:i" }}</p>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Last Updated</label>
                                <p class="text-sm">{{ subscription.updated_at|date:"M d, Y H:i" }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title text-lg mb-4">Quick Actions</h3>
                        <div class="space-y-2">
                            <a href="{% url 'subscriptions:subscription_update' subscription.pk %}" class="btn btn-primary btn-sm w-full">
                                Edit Subscription
                            </a>
                            <a href="{% url 'subscriptions:subscription_delete' subscription.pk %}" class="btn btn-error btn-sm w-full">
                                Delete Subscription
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}