{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-base-100 to-base-200">
    <!-- Welcome Header -->
    <div class="bg-gradient-to-r from-primary to-secondary text-primary-content p-8">
        <div class="container mx-auto">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold mb-2">Welcome back, {{ user.username }}!</h1>
                    <p class="text-lg opacity-90">Here's what's happening with your content today.</p>
                </div>
                <div class="hidden md:flex items-center gap-4">
                    <div class="text-right">
                        <p class="text-sm opacity-75">Last login</p>
                        <p class="font-semibold">{{ user.last_login|date:"M d, Y"|default:"Today" }}</p>
                    </div>
                    <div class="avatar placeholder">
                        <div class="bg-primary-focus text-primary-content rounded-full w-12 h-12">
                            <span class="text-lg">{{ user.username|first|upper }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-6">
        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Files Stats -->
            <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow">
                <div class="card-body">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-blue-600">{{ stats.total_files }}</h3>
                            <p class="text-base-content/70">Total Files</p>
                        </div>
                        <div class="bg-blue-100 p-3 rounded-full">
                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="card-actions justify-end mt-4">
                        <a href="{% url 'files:file_list' %}" class="btn btn-sm btn-outline btn-blue">View All</a>
                    </div>
                </div>
            </div>

            <!-- Images Stats -->
            <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow">
                <div class="card-body">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-green-600">{{ stats.total_images }}</h3>
                            <p class="text-base-content/70">Total Images</p>
                        </div>
                        <div class="bg-green-100 p-3 rounded-full">
                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="card-actions justify-end mt-4">
                        <a href="{% url 'images:image_list' %}" class="btn btn-sm btn-outline btn-green">View All</a>
                    </div>
                </div>
            </div>

            <!-- Prompts Stats -->
            <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow">
                <div class="card-body">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-purple-600">{{ stats.total_prompts }}</h3>
                            <p class="text-base-content/70">Total Prompts</p>
                        </div>
                        <div class="bg-purple-100 p-3 rounded-full">
                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="card-actions justify-end mt-4">
                        <a href="{% url 'prompts:prompt_list' %}" class="btn btn-sm btn-outline btn-purple">View All</a>
                    </div>
                </div>
            </div>

            <!-- Searches Stats -->
            <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow">
                <div class="card-body">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-orange-600">{{ stats.total_searches }}</h3>
                            <p class="text-base-content/70">Searches</p>
                        </div>
                        <div class="bg-orange-100 p-3 rounded-full">
                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="card-actions justify-end mt-4">
                        <a href="{% url 'search:search' %}" class="btn btn-sm btn-outline btn-orange">Search</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Quick Actions -->
            <div class="lg:col-span-1">
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4">
                            <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                            </svg>
                            Quick Actions
                        </h2>
                        <div class="space-y-3">
                            {% for action in quick_actions %}
                                <a href="{{ action.url }}" class="btn btn-outline w-full justify-start">
                                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        {% if action.icon == 'document-plus' %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        {% elif action.icon == 'photo-plus' %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                        {% elif action.icon == 'light-bulb-plus' %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                        {% elif action.icon == 'user' %}
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                        {% endif %}
                                    </svg>
                                    <div class="text-left">
                                        <div class="font-semibold">{{ action.title }}</div>
                                        <div class="text-xs opacity-70">{{ action.description }}</div>
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Recent Searches -->
                {% if recent_searches %}
                    <div class="card bg-base-100 shadow-xl mt-6">
                        <div class="card-body">
                            <h2 class="card-title text-xl mb-4">
                                <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                                Recent Searches
                            </h2>
                            <div class="space-y-2">
                                {% for search in recent_searches %}
                                    <a href="{% url 'search:search' %}?q={{ search.query }}" 
                                       class="block p-2 rounded-lg hover:bg-base-200 transition-colors">
                                        <div class="flex items-center justify-between">
                                            <span class="font-medium">{{ search.query }}</span>
                                            <span class="text-xs text-base-content/50">{{ search.created_at|timesince }} ago</span>
                                        </div>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>

            <!-- Recent Activity -->
            <div class="lg:col-span-2">
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h2 class="card-title text-xl mb-4">
                            <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                            </svg>
                            Recent Activity
                        </h2>
                        
                        {% if recent_activity %}
                            <div class="space-y-4">
                                {% for activity in recent_activity %}
                                    <div class="flex items-center gap-4 p-3 rounded-lg hover:bg-base-200 transition-colors">
                                        <div class="avatar placeholder">
                                            <div class="bg-{{ activity.color }}-100 text-{{ activity.color }}-600 rounded-lg w-10 h-10">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    {% if activity.icon == 'document' %}
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                    {% elif activity.icon == 'photo' %}
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                                    {% elif activity.icon == 'light-bulb' %}
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                                    {% endif %}
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <a href="{{ activity.url }}" class="font-semibold hover:text-primary">
                                                {{ activity.title }}
                                            </a>
                                            <p class="text-sm text-base-content/70">
                                                {{ activity.type|title }} • {{ activity.date|timesince }} ago
                                            </p>
                                        </div>
                                        <div class="badge badge-{{ activity.color }} badge-sm">
                                            {{ activity.type|title }}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="text-center py-8">
                                <svg class="w-16 h-16 mx-auto text-base-content/30 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <h3 class="text-lg font-semibold mb-2">No recent activity</h3>
                                <p class="text-base-content/70">Start by uploading files, images, or creating prompts!</p>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Popular Categories -->
                {% if popular_categories %}
                    <div class="card bg-base-100 shadow-xl mt-6">
                        <div class="card-body">
                            <h2 class="card-title text-xl mb-4">
                                <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                                </svg>
                                Popular Categories
                            </h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                {% for category in popular_categories %}
                                    <a href="{% url 'prompts:category_detail' category.pk %}" 
                                       class="card bg-base-200 hover:bg-base-300 transition-colors">
                                        <div class="card-body p-4">
                                            <div class="flex items-center gap-2">
                                                <div class="w-3 h-3 rounded-full" style="background-color: {{ category.color }};"></div>
                                                <h3 class="font-semibold text-sm">{{ category.name }}</h3>
                                            </div>
                                            <p class="text-xs text-base-content/70 mt-1">{{ category.prompt_count }} prompts</p>
                                        </div>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Recent Content Grid -->
        <div class="mt-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Recent Files -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="card-title text-lg">
                                <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                Recent Files
                            </h2>
                            <a href="{% url 'files:file_list' %}" class="btn btn-sm btn-outline">View All</a>
                        </div>
                        
                        {% if recent_files %}
                            <div class="space-y-3">
                                {% for file in recent_files %}
                                    <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-base-200 transition-colors">
                                        <div class="avatar placeholder">
                                            <div class="bg-blue-100 text-blue-600 rounded-lg w-8 h-8">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <a href="{% url 'files:file_detail' file.id %}" class="font-medium hover:text-blue-600 truncate block">
                                                {{ file.title }}
                                            </a>
                                            <p class="text-xs text-base-content/50">{{ file.uploaded_at|timesince }} ago</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="text-center py-4">
                                <p class="text-base-content/60">No files uploaded yet</p>
                                <a href="{% url 'files:file_upload' %}" class="btn btn-sm btn-primary mt-2">Upload File</a>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Recent Images -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="card-title text-lg">
                                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                                Recent Images
                            </h2>
                            <a href="{% url 'images:image_list' %}" class="btn btn-sm btn-outline">View All</a>
                        </div>
                        
                        {% if recent_images %}
                            <div class="space-y-3">
                                {% for image in recent_images %}
                                    <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-base-200 transition-colors">
                                        <div class="avatar placeholder">
                                            <div class="bg-green-100 text-green-600 rounded-lg w-8 h-8">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <a href="{% url 'images:image_detail' image.id %}" class="font-medium hover:text-green-600 truncate block">
                                                {{ image.title }}
                                            </a>
                                            <p class="text-xs text-base-content/50">{{ image.uploaded_at|timesince }} ago</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="text-center py-4">
                                <p class="text-base-content/60">No images uploaded yet</p>
                                <a href="{% url 'images:image_upload' %}" class="btn btn-sm btn-primary mt-2">Upload Image</a>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Recent Prompts -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="card-title text-lg">
                                <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                </svg>
                                Recent Prompts
                            </h2>
                            <a href="{% url 'prompts:prompt_list' %}" class="btn btn-sm btn-outline">View All</a>
                        </div>
                        
                        {% if recent_prompts %}
                            <div class="space-y-3">
                                {% for prompt in recent_prompts %}
                                    <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-base-200 transition-colors">
                                        <div class="avatar placeholder">
                                            <div class="bg-purple-100 text-purple-600 rounded-lg w-8 h-8">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <a href="{% url 'prompts:prompt_detail' prompt.slug %}" class="font-medium hover:text-purple-600 truncate block">
                                                {{ prompt.title }}
                                            </a>
                                            <p class="text-xs text-base-content/50">{{ prompt.created_at|timesince }} ago</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="text-center py-4">
                                <p class="text-base-content/60">No prompts created yet</p>
                                <a href="{% url 'prompts:prompt_create' %}" class="btn btn-sm btn-primary mt-2">Create Prompt</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}